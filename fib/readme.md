
# Fibコアシミュレータver1.40α, アセンブラ
## 使用方法
### シミュレータ
makeコマンドでmainファイルを作成し、「`./main fib.s`」のように実行ファイルを入力としてください。
その後、以下のコマンドを実行してアセンブリの挙動を確かめられます。
- `a`   ... (all) 全実行
- `nb`  ... (next break) 次のブレークポイントまで実行
- `n`   ... (next) 次の命令のみを実行
- `bs [lineN]` ... (break set) `[lineN]`行目にブレークポイントを追加
- `bl`  ... (break list) ブレークポイントのリストを表示
- `bd [lineN]` ... (break delete) `[lineN]`行目のブレークポイントを削除
- `rr ([regName]) (-[base], -[signed])`  ... (register read) `[regName]`のレジスタを`[base]`進法、符号の有無を`[signed]`で表示。
    - `[regname]` ... デフォルトは全レジスタの表示
    - `[base]`    ... b, o, d, h (デフォルトはd)
    - `[signed]`  ... uで符号なしとして表示（デフォルトは符号付） 

- `rw　[regName] [value] (-[base])`  ... (register write) `[regName]`のレジスタに`[base]`進法で`[value]`の値を書き込む。`[base]`はb, o, d, h (デフォルトはd)から選ぶ。unsignedは実装していません。
- `i`   ... (info) これまでの実行命令数などの情報を表示
- `re`  ... (reset) レジスタ群、ブレークポイント、統計情報などのデータをリセットして初期状態に戻す
- `ba`   ... (back) 1命令もとに戻す（1024回まで）


### アセンブラ
`make assembler`でassemblerファイルを作り、実行してください。あとはプロンプトの指示にしたがって入力ファイルなどを指定すれば出力されます。


## 注意
- g++, makeを実行できる環境が必要です。（aptなどでインストールしてください。）
- intが4バイトであることを暗黙に用いているので注意してください

## アセンブリの仕様
- ラベル名に使用可能なのはa-Z, 0-9, 記号は_のみ。大文字小文字区別する。
    - 同一ラベルがあった場合、パース時にエラーを吐く
- ラベル名の後ろにはコロンをつける
    - ラベルとコロンの間に空白文字が合ってもよいが、ラベル登録時に空白文字は消す
- 行が空白文字（タブ、半角空白）から始まる場合は命令とみなす
    - インデントの数は自由
- オペコードは小文字のみ
    - 現在対応しているのはadd, addi, nop, beq, blt, jの６つ
- レジスタはx0(zero), x1~x31, pcの32+1個
- シャープの後ろはコメント

## その他留意点
- ALUのオーバーフローは処理しない（RISC-Vの仕様？）

## todo


## バージョン履歴
- 1.00 ... とりあえずファイルを読み込んでの実行を可能に
- 1.10 ... バグ修正、一部の対話実行機能を追加
- 1.20 ... バグ修正、コアとなる対話機能を実装
- 1.30 ... バグ修正、バック機能追加
- 1.40 ... バグ修正、アセンブラ追加


